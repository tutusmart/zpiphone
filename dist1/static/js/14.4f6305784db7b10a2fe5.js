webpackJsonp([14],{Pi5D:function(t,a){},Toab:function(t,a){},XhiN:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"ManualAuditList",components:{PassAndNoPass:e("eu7k").a},data:function(){return{errorTip:"请选择待审核的登记手册",loading:!1,finished:!1,error:!1,title:"审核时间",currentPage:1,startTime:this.utils.formatDate((new Date).getTime(),"yyyy-MM"),startTimeShow:this.utils.formatDate((new Date).getTime(),"yyyy-MM").replace(/-/g,"/"),currentDate:new Date(this.$store.state.timestamp.replace(/-/g,"/")),timeShow:!1,auditNote:"",manualAuditList:[],currentIndex:this.tab,tabPageFlag:this.tabFlg}},methods:{onLoad:function(){this.getData()},getData:function(t){var a=this;this.currentPage=Math.ceil(this.manualAuditList.length/this.$store.state.pageSize),this.currentPage=this.currentPage+1,t&&(this.currentPage=1);var e={currentPage:t||this.currentPage,pageSize:this.$store.state.pageSize};0==this.currentIndex?e.auditFlags=["0"]:1==this.currentIndex&&(e.auditFlags=["1","2"]),e.auditDate=this.startTime,this.utils.ajax({url:this.api.pagingEnrollmentAuditList,data:e,method:"POST",success:function(t){a.manualAuditList=1==e.currentPage?a.transformData(t.content):a.manualAuditList.concat(a.transformData(t.content)),a.totalElements=t.totalElements,a.totalPages=t.totalPages,a.loading=!1,e.currentPage>=a.totalPages?a.finished=!0:a.finished=!1}},!0)},transformData:function(t){var a=this;return t.forEach(function(t){t.selected=!1,t.twoLevelTypeText=a.utils.getValueByKey(a.$store.state.twoLevelType,t.twoLevelType),t.traineeMajorCodeText=a.utils.getValueByKey(a.$store.state.majors,t.traineeMajorCode),t.createDateText=t.createDate?a.utils.formatDate(t.createDate).replace(/-/g,"/"):"",t.auditDateText=t.auditDate?a.utils.formatDate(t.auditDate).replace(/-/g,"/"):"",t.auditFlagText=a.utils.getValueByKey(a.$store.state.auditStatus,t.auditFlag)||""}),t},formatter:function(t,a){return this.utils.pickerType(t,a)},getParams:function(){var t={},a=[];return this.checkedList().forEach(function(t,e){a.push(t.id)}),t.ids=a,1==this.btnType?t.auditNote="":0==this.btnType&&(t.auditNote=this.auditNote),t},auditAjax:function(){var t=this,a="";0==this.btnType?a=this.api.manualReject:1==this.btnType&&(a=this.api.manualApproval);var e=this.getParams(this.btnType);this.utils.ajax({url:a,data:e,method:"POST",success:function(a){setTimeout(function(){t.Toast("审核成功")},100),t.getData(1)},error:function(a){console.log("error--\x3e--",a),t.Toast(a.error)}},!0)},checkedList:function(){var t=this.manualAuditList.filter(function(t){return 1==t.selected});return t},manualAudit:function(t){var a=t.type;if("pass"==a){if(this.btnType=1,0==this.checkedList().length)return void this.Toast(this.error)}else"unPass"==a&&(this.btnType=0);this.auditNote=t.data||"",this.auditAjax()},timeSelected:function(){this.timeShow=!0},conformDate:function(t){this.startTime=this.utils.formatDate(t.getTime(),"yyyy-MM"),this.startTimeShow=this.startTime.replace(/-/g,"/"),console.log("xxxxxx"),this.getData(1),this.cancleDate()},cancleDate:function(){this.timeShow=!1},manualAuditClick:function(t){0==this.tab&&(t.selected=!t.selected)},viewManualDetail:function(t,a){t.stopPropagation(),this.manualAuditList.forEach(function(t){t.selected=!1}),a.selected=!0,this.$router.push({name:"ManualAuditDetail",params:{oneLevelType:a.oneLevelType,twoLevelType:a.twoLevelType,tab:this.tab,item:a}})}},created:function(){this.tab?this.title="审核时间":this.title="提交时间"},props:["tab","tabFlg"]},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"manualAuditCont"},[e("div",{staticClass:"auditTime"},[e("van-cell",{attrs:{title:t.title,"is-link":"",value:t.startTimeShow},on:{click:t.timeSelected}})],1),t._v(" "),e("van-list",{attrs:{finished:t.finished,error:t.error,"error-text":"请求失败，点击重新加载","finished-text":"没有更多了",offset:50},on:{"update:error":function(a){t.error=a},load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[e("div",{staticClass:"manualAuditList"},[e("ul",t._l(t.manualAuditList,function(a,i){return e("li",{class:{active:a.selected},on:{click:function(e){return t.manualAuditClick(a)}}},[e("div",{staticClass:"item"},[e("span",{staticClass:"title"},[t._v("学员 :")]),e("span",{staticClass:"text"},[t._v(t._s(a.studentName))])]),t._v(" "),0==t.tab?e("div",{staticClass:"item"},[e("span",{staticClass:"title"},[t._v("专业 :")]),e("span",{staticClass:"text"},[t._v(t._s(a.traineeMajorCodeText))])]):t._e(),t._v(" "),0==t.tab?e("div",{staticClass:"item"},[e("span",{staticClass:"title"},[t._v("轮转科室 :")]),e("span",{staticClass:"text"},[t._v(t._s(a.departmentName))])]):t._e(),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"title"},[t._v("手册类型 :")]),e("span",{staticClass:"text"},[t._v(t._s(a.twoLevelTypeText))])]),t._v(" "),1==t.tab?e("div",{staticClass:"item"},[e("span",{staticClass:"title"},[t._v("审核人 :")]),e("span",{staticClass:"text"},[t._v(t._s(a.auditHumanName))])]):t._e(),t._v(" "),1==t.tab?e("div",{staticClass:"item"},[e("span",{staticClass:"title"},[t._v("审核状态 :")]),t._v(" "),e("span",{staticClass:"text",class:{green:1==a.auditFlag,red:2==a.auditFlag,blue:0==a.auditFlag||3==a.auditFlag}},[t._v(t._s(a.auditFlagText))])]):t._e(),t._v(" "),e("div",{staticClass:"item last"},[0==t.tab?e("div",[e("span",{staticClass:"title"},[t._v("提交时间 :")]),e("span",{staticClass:"text"},[t._v(t._s(a.createDateText))])]):t._e(),t._v(" "),1==t.tab?e("div",[e("span",{staticClass:"title"},[t._v("审核时间 :")]),e("span",{staticClass:"text"},[t._v(t._s(a.auditDateText))])]):t._e(),t._v(" "),e("div",{staticClass:"button-box"},[e("span",{staticClass:"a",on:{click:function(e){return t.viewManualDetail(e,a)}}},[t._v("查看")])])])])}),0)])]),t._v(" "),0==t.tab?e("PassAndNoPass",{class:0==t.tab?"mt":"",attrs:{error:t.errorTip,list:t.manualAuditList},on:{auditHandle:t.manualAudit}}):t._e(),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.timeShow,callback:function(a){t.timeShow=a},expression:"timeShow"}},[e("van-datetime-picker",{attrs:{type:"year-month",formatter:t.formatter},on:{confirm:t.conformDate,cancel:t.cancleDate},model:{value:t.currentDate,callback:function(a){t.currentDate=a},expression:"currentDate"}})],1)],1)},staticRenderFns:[]};var n={name:"ManualAudit",components:{ManualAuditList:e("VU/8")(i,s,!1,function(t){e("Toab")},"data-v-78291edb",null).exports},data:function(){return{active:0,tabFlag:!0}},methods:{onClickLeft:function(){this.$store.state.tabActive=0,this.utils.goBack(this)},change:function(t,a){document.querySelector(".layout_content").scrollTop=0,this.active=t,this.$store.state.tabActive=this.active}},created:function(){this.active=this.$store.state.tabActive}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"manualAudit"},[e("van-nav-bar",{staticClass:"header",attrs:{title:"手册审核",fixed:"","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),e("div",{staticClass:"layout_content"},[e("van-tabs",{attrs:{sticky:"","offset-top":40,swipeable:"","title-active-color":"#1a7fe9",color:"#5fa4ec","line-height":2},on:{change:t.change},model:{value:t.active,callback:function(a){t.active=a},expression:"active"}},[e("van-tab",{attrs:{title:"待审核"}},[e("ManualAuditList",{ref:"mychild1",attrs:{tab:t.active,tabFlg:t.tabFlag}})],1),t._v(" "),e("van-tab",{attrs:{title:"已审核"}},[e("ManualAuditList",{ref:"mychild2",attrs:{tab:t.active,tabFlg:t.tabFlag}})],1)],1)],1)],1)},staticRenderFns:[]};var r=e("VU/8")(n,l,!1,function(t){e("Pi5D")},"data-v-26be509e",null);a.default=r.exports}});
//# sourceMappingURL=14.4f6305784db7b10a2fe5.js.map
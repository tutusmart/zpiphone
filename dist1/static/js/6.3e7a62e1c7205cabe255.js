webpackJsonp([6],{bV4E:function(t,e){},e0W2:function(t,e){},jmA9:function(t,e,s){t.exports=s.p+"static/img/pic20190424.2e498a7.jpg"},kluF:function(t,e){},lO7g:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.modules?s("div",t._l(t.modules,function(e){return s("div",{staticClass:"module"},[s("div",{staticClass:"module_title"},[t._v(t._s(e.title))]),t._v(" "),s("div",{staticClass:"rowWarp"},t._l(e.columns,function(e,i){return s("div",{staticClass:"swipeList",style:{left:t.leftFn(i)},on:{click:function(s){return t.href(e)}}},[s("p",{class:e.icon}),t._v(" "),s("span",[t._v(t._s(e.name))])])}),0)])}),0):t._e()},staticRenderFns:[]};var a={name:"HomeRotation",data:function(){return{showPivot:!1,rotationDetail:{departmentName:"",rotationTime:"",startTime:"",endTime:"",totalDays:0,outDepartment:0,entry:0,teacherName:""},daysText:"距离出科",enrollmentStatistics:{otherNum:0,percentageDiseases:0,percentageSkill:0}}},methods:{getRotation:function(){var t=this,e={studentId:this.$store.state.userInfo.human.caId};this.$store.state.curDepartmentTime&&(e.currTime=this.$store.state.curDepartmentTime.endDate),this.utils.ajax({method:"POST",url:this.api.homeRotation,data:e,success:function(e){if(t.$store.state.currentDepartment=e.phoneMyCycleInfo,e.enrollmentStatistics&&(t.enrollmentStatistics=e.enrollmentStatistics,t.$store.state.currentDepartment.normalDepartmentId=e.enrollmentStatistics.normalDepartmentId,t.$store.state.currentDepartment.departmentCaId=e.enrollmentStatistics.departmentCaId),e.phoneMyCycleInfo){var s=e.phoneMyCycleInfo,i=t.utils.formatDate(t.$store.state.timestamp,"yyyy-MM-dd");s.startDate=t.utils.formatDate(s.startTime,"yyyy-MM-dd"),s.endDate=t.utils.formatDate(s.endTime,"yyyy-MM-dd");var a=t.utils.getTime(i)<=t.utils.getTime(s.startTime),n=t.utils.getTime(i)>=t.utils.getTime(s.endTime);a||n?(s.outDepartment=Math.ceil((t.utils.getTime(s.endTime)-t.utils.getTime(s.startTime))/864e5),a?(s.entry=0,s.entryStatus=0):(s.entry=100,s.entryStatus=2),t.daysText="轮转天数"):(s.totalDays=(t.utils.getTime(s.endDate)-t.utils.getTime(s.startDate))/864e5,s.outDepartment=(t.utils.getTime(s.endDate)-t.utils.getTime(i))/864e5,s.entry=((s.totalDays-s.outDepartment)/s.totalDays*100).toFixed(2)-0,t.daysText="距离出科"),s.startTime&&(s.rotationTime=s.startDate+"~"+s.endDate),s.teacherName=s.teacherName.split(",")[0],s.entryText=s.entryStatus?1===s.entryStatus?"已入科":"已出科":"未入科",t.rotationDetail=s}},error:function(e){t.$store.state.currentDepartment=null,t.Toast(e.error)}})},viewRotation:function(){this.$router.push({name:"RotationPlan"})},viewRegister:function(){this.$router.push({name:"RegistrationManual"})},bgColor:function(t){return 0===t.entryStatus?"#e44444":t.entryStatus?"#4ebc7f":""}},created:function(){this.getRotation()}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"module rotation"},[s("van-cell",{attrs:{title:"我的轮转","is-link":"",value:"查看全部"},on:{click:t.viewRotation}}),t._v(" "),s("van-row",[s("van-col",{attrs:{span:"12"}},[s("div",{staticClass:"br rotation_detail"},[s("div",{staticClass:"department"},[t._v(t._s(t.rotationDetail.departmentName)+"\n          "),s("span",{staticClass:"entry_flag",style:{background:t.bgColor(t.rotationDetail)}},[t._v(t._s(t.rotationDetail.entryText))])]),t._v(" "),s("div",{staticClass:"entry_time van-ellipsis"},[t._v(t._s(t.rotationDetail.rotationTime))]),t._v(" "),s("div",{staticClass:"relative"},[s("p",[s("span",[t._v(t._s(t.daysText))])]),s("div",{staticClass:"days"},[s("span",[t._v(t._s(t.rotationDetail.outDepartment))]),t._v("天")]),t._v(" "),s("p")]),t._v(" "),s("p",[s("van-progress",{attrs:{"show-pivot":t.showPivot,color:"linear-gradient(to right, #1186ff, #50cc87)",percentage:t.rotationDetail.entry}})],1),t._v(" "),s("div",[t._v("带教老师："+t._s(t.rotationDetail.teacherName))])])]),t._v(" "),s("van-col",{attrs:{span:"12"}},[s("div",{staticClass:"register_detail",on:{click:t.viewRegister}},[s("div",{staticClass:"center"},[t._v("登记手册")]),t._v(" "),s("p"),s("div",{staticClass:"pb2"},[t._v("病种")]),t._v(" "),s("div",[s("van-progress",{attrs:{"show-pivot":t.showPivot,color:"linear-gradient(to right, #1186ff, #42afff)",percentage:t.enrollmentStatistics.percentageDiseases}})],1),t._v(" "),s("p"),t._v(" "),s("p"),s("div",{staticClass:"pb2"},[t._v("技能")]),t._v(" "),s("div",[s("van-progress",{attrs:{"show-pivot":t.showPivot,color:"linear-gradient(to right, #1186ff, #42afff)",percentage:t.enrollmentStatistics.percentageSkill}})],1),t._v(" "),s("p"),t._v(" "),s("div",{staticClass:"relative other"},[t._v("其他录入 "),s("span",[t._v(t._s(t.enrollmentStatistics.otherNum)+"份")])])])])],1)],1)},staticRenderFns:[]};var r={name:"HomeActive",data:function(){return{loading:!1,finished:!1,error:!1,currentPage:0,finishedMsg:"没有更多了",activityList:[],activityPager:{},teaching:"teaching_activity"}},methods:{onLoad:function(){var t=this;this.currentPage=Math.ceil(this.activityList.length/5)+1,this.utils.ajax({method:"POST",url:this.api.homeActivity,data:{currentPage:this.currentPage,pageSize:5,flagOfRelease:2,isStart:0,isSignUp:1,joinFlags:[0,2]},success:function(e){t.finishedMsg="没有更多了",t.activityPager=e,e.content.length?e.content.forEach(function(e){if(1===e.isSignUp){var s=e.startTime.replace(/-/g,"/");e.signInDate=t.utils.formatDate(new Date(s).getTime()-72e5)+" 前"}else e.signInDate="无需报名";e.startTime=t.utils.formatDate(e.startTime),e.endTime=t.utils.formatDate(e.endTime),t.activityList.push(e)}):t.finishedMsg="暂无数据",t.loading=!1,t.currentPage>=t.activityPager.totalPages&&(t.finished=!0)},error:function(e){t.loading=!1,t.error=!0}},!0)},activityView:function(t){this.$store.state.activitiesDetailsObj={id:t.id,condition:this.teaching,memberCaId:t.memberCaId},this.$router.push({name:"ActivitiesDetails"})}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"activity"},[s("van-cell",{attrs:{title:"教学活动",value:"查看全部","is-link":"",to:"TeachingActivities"}}),t._v(" "),s("van-list",{attrs:{finished:t.finished,error:t.error,"error-text":"请求失败，点击重新加载","finished-text":t.finishedMsg,"immediate-check":"",offset:50},on:{"update:error":function(e){t.error=e},load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",{staticClass:"activityList"},[s("ul",t._l(t.activityList,function(e){return s("li",{on:{click:function(s){return t.activityView(e)}}},[s("div",{staticClass:"activity_title"},[t._v(t._s(e.title))]),t._v(" "),s("p",{staticClass:"activity_time"},[t._v("报名时间： "+t._s(e.signInDate))]),t._v(" "),s("p",{staticClass:"activity_time"},[t._v("活动时间： "+t._s(e.startTime)+" 至 "+t._s(e.endTime))])])}),0)])])],1)},staticRenderFns:[]};var l={name:"Home",components:{HomeMenu:s("VU/8")({name:"HomeMenu",components:{},data:function(){return{}},methods:{href:function(t){var e=t.type;"inside"===e?this.$router.push({name:t.path,query:t.query,params:t.params}):"build"===e?this.Toast("模块正在建设中"):"external"===e&&this.webApp.WebCallApp("CmdOpenUrl",{url:this.$store.state.jumpAdress[t.path]+"?token="+this.utils.getCookie("previous-token")})},leftFn:function(t){return 22*t+"%"}},created:function(){},props:["modules"]},i,!1,function(t){s("e0W2")},"data-v-32b4dc30",null).exports,HomeRotation:s("VU/8")(a,n,!1,function(t){s("kluF")},"data-v-55f4bd2a",null).exports,HomeActive:s("VU/8")(r,o,!1,function(t){s("bV4E")},"data-v-08dace05",null).exports},data:function(){return{currentName:"",isJump:!1,userInfo:{},show:!1,isTourist:!1,rolesShow:!1,showModel:!1,isLoading:!1,refreshText:!1,columns:[],modules:[]}},methods:{login:function(){var t=this;this.webApp.WebCallApp("GetAPPVersion",{},function(e){"1"==e.result.touristsState?t.isTourist=!0:t.getUserInfo()}),this.$store.state.departmentList||this.getDepartmentList()},getUserInfo:function(){var t=this;this.utils.ajax({method:"post",url:this.api.userInfo,success:function(e){console.log(e,"aaaaa"),t.$store.state.userInfo=e,t.userInfo=e,t.columns=[];var s=[];e.roleVOs.forEach(function(t){return s.push(t.code)}),t.$store.state.roleList.forEach(function(e){if(s.indexOf(e.key)>-1){var i={key:e.key,text:e.value};t.columns.push(i)}}),console.log(t.userInfo.currentRole.code,"oooo"),t.currentName=t.utils.getValueByKey(t.$store.state.roleList,t.userInfo.currentRole.code),t.modules=t.$store.state[t.userInfo.currentRole.code+"Modules"],t.rolesShow="student"!==t.userInfo.currentRole.code,t.showModel=!0,t.isLoading=!1,t.refreshText=!1},error:this.jumpAdress,catch:this.onError},!0)},changeRole:function(t){var e=this;this.show=!1,this.utils.ajax({method:"post",url:this.api.changeRole,data:{roleCode:t},success:function(t){e.getUserInfo()}},!0)},showChangeList:function(){this.show=!this.show},hideMask:function(){this.show=!1},onRefresh:function(){this.login()},onError:function(t){this.isLoading=!1,this.refreshText=!0,t.error=t.error||"网络异常",this.Toast(t.error)},jumpAdress:function(t){var e=this;this.isJump=!0,this.Toast.loading({mask:!0,message:"加载中...",duration:0}),setTimeout(function(){e.Toast.clear(),window.location.href=e.$store.state.jumpAdress[360]+"?token="+e.utils.getCookie("previous-token")+"&onlyYou=1"},1500)},refresh:function(){this.login()},getDepartmentList:function(){var t=this;this.utils.ajax({method:"POST",url:this.api.queryAllDepartments,success:function(e){e&&(e.forEach(function(t){t.key=t.caId,t.value=t.name}),t.$store.state.departmentList=e)}},!0)}},created:function(){this.login()}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isJump?t._e():i("div",[i("van-nav-bar",{staticClass:"header",attrs:{title:"教学管理",fixed:"",border:""}}),t._v(" "),t.isTourist?i("img",{staticClass:"tourist",attrs:{src:s("jmA9")},on:{click:function(e){return t.Toast("无权限")}}}):i("div",{staticClass:"layout_content"},[i("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[t.showModel?i("div",{staticClass:"homeWarp"},[t.rolesShow?i("div",{staticClass:"module roles"},[i("van-cell",{attrs:{title:t.show?"选择角色":"当前角色 :","is-link":"","arrow-direction":t.show?"down":"",value:t.show?"":t.currentName},on:{click:t.showChangeList}}),t._v(" "),t.show?i("ul",{staticClass:"rolesUl"},t._l(t.columns,function(e){return i("li",{staticClass:"rolesList",on:{click:function(s){return t.changeRole(e.key)}},model:{value:e.key,callback:function(s){t.$set(e,"key",s)},expression:"lis.key"}},[t._v(t._s(e.text)+"\n            ")])}),0):t._e()],1):t._e(),t._v(" "),i("HomeMenu",{attrs:{modules:t.modules}}),t._v(" "),t.rolesShow?t._e():i("HomeRotation"),t._v(" "),i("HomeActive")],1):t._e(),t._v(" "),t.refreshText?i("div",{staticClass:"refreshWarp"},[t._v("加载失败请下拉刷新")]):t._e(),t._v(" "),t.show?i("div",{staticClass:"van-overlay",on:{click:t.hideMask}}):t._e()])],1)],1)},staticRenderFns:[]};var u=s("VU/8")(l,c,!1,function(t){s("quX3")},"data-v-ee8a6172",null);e.default=u.exports},quX3:function(t,e){}});
//# sourceMappingURL=6.3e7a62e1c7205cabe255.js.map
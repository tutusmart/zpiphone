webpackJsonp([44],{jBeb:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"ShowTeacher",data:function(){return{teacherName:"",timeData:[],showTimer:!1,timeMode:"",editIndex:"",minDate:"",maxDate:"",currentDate:new Date,params:null}},methods:{onClickLeft:function(){this.utils.goBack(this)},onClickRight:function(){var t=this;console.log("save"),console.log(this.timeData);var e=[];if(this.timeData.forEach(function(t){if(!t.edit){var a={endDate:t.end,startDate:t.start};e.push(a)}}),e.length>0){var a={allotTeachers:[]},i=this.params;i.allotTimes=e,a.allotTeachers.push(i),this.utils.ajax({url:this.api.allotTeacher,method:"post",data:a,success:function(e){console.log(e),t.Toast("保存成功"),t.$router.go(-2)}})}else this.Toast("请选择带教时间")},chooseDateStart:function(t,e,a){this.showTimer||(this.showTimer=!0,this.timeMode=e,this.editIndex=a,console.log(this.params.cycleStartTime),console.log(this.params.cycleEndTime),console.log(t),"start"==e?(this.currentDate=new Date(this.params.cycleStartTime.replace(/-/g,"/")),this.minDate=new Date(this.params.cycleStartTime.replace(/-/g,"/")),t.end?this.maxDate=new Date(t.end.replace(/-/g,"/")):this.maxDate=new Date(this.params.cycleEndTime.replace(/-/g,"/"))):(this.currentDate=new Date(this.params.cycleEndTime.replace(/-/g,"/")),this.maxDate=new Date(this.params.cycleEndTime.replace(/-/g,"/")),t.start?this.minDate=new Date(t.start.replace(/-/g,"/")):this.minDate=new Date(this.params.cycleStartTime.replace(/-/g,"/"))))},confirm:function(t){var e=this,a=t.getFullYear()+"-"+this.timeRule(t.getMonth(),"month")+"-"+this.timeRule(t.getDate()),i=!0,s=new Date(a.replace(/-/g,"/"));this.timeData.forEach(function(t,a){var n=void 0,r=void 0;t.start&&t.end&&e.editIndex!=a&&!t.edit&&(n=new Date(t.start.replace(/-/g,"/")).getTime(),r=new Date(t.end.replace(/-/g,"/")).getTime(),s>=n&&s<=r&&(i=!1))}),i?(this.timeData[this.editIndex][this.timeMode]=a,this.showTimer=!1):this.Toast("该时间区间已被选取")},timeRule:function(t,e){return"month"==e&&t++,t>9?t:"0"+t},cancel:function(){this.showTimer=!1},suerTime:function(t){t.start?t.end?(t.str=t.start+"至"+t.end,t.edit=!1):this.Toast("请选择结束时间"):this.Toast("请选择开始时间")},edit:function(t){t.edit=!0},del:function(t){var e=[];this.timeData.forEach(function(a,i){t!=i&&e.push(a)}),this.timeData=e},addDate:function(){0!=this.timeData.length?this.timeData[this.timeData.length-1].start&&this.timeData[this.timeData.length-1].end&&this.timeData.push({edit:!0}):this.timeData.push({edit:!0})},loadData:function(){this.params=this.$route.params.params,this.minDate=new Date(this.params.cycleStartTime.replace(/-/g,"/")),this.maxDate=new Date(this.params.cycleEndTime.replace(/-/g,"/")),this.teacherName=this.$route.params.teacherName,this.timeData=[]}},created:function(){this.$route.params.teacherName&&this.loadData()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{staticClass:"header",attrs:{title:t.teacherName,"right-text":"保存",fixed:"","left-arrow":""},on:{"click-right":t.onClickRight,"click-left":t.onClickLeft}}),t._v(" "),a("div",{staticClass:"layout_content"},[a("div",{staticClass:"headTime"},[t._v("带教时间")]),t._v(" "),a("ul",t._l(t.timeData,function(e,i){return a("li",[e.edit?t._e():a("van-swipe-cell",{attrs:{"right-width":130}},[a("van-cell-group",[a("van-cell",{attrs:{title:e.str}})],1),t._v(" "),a("span",{staticClass:"btn btn-edit",attrs:{slot:"right"},on:{click:function(a){return t.edit(e)}},slot:"right"},[t._v("编辑")]),t._v(" "),a("span",{staticClass:"btn btn-del",attrs:{slot:"right"},on:{click:function(e){return t.del(i)}},slot:"right"},[t._v("删除")])],1),t._v(" "),e.edit?a("div",{staticClass:"edit"},[a("div",[a("input",{attrs:{type:"text",readonly:"",placeholder:"请选择开始时间"},domProps:{value:e.start},on:{click:function(a){return t.chooseDateStart(e,"start",i)}}}),t._v(" "),a("span",[t._v("至")]),t._v(" "),a("input",{attrs:{type:"text",readonly:"",placeholder:"请选结束始时间"},domProps:{value:e.end},on:{click:function(a){return t.chooseDateStart(e,"end",i)}}})]),t._v(" "),a("span",{staticClass:"btn-suer",on:{click:function(a){return t.suerTime(e)}}},[t._v("确认")])]):t._e()],1)}),0),t._v(" "),a("div",{staticClass:"addTime",on:{click:t.addDate}},[a("van-icon",{staticClass:"add",attrs:{name:"add"}}),t._v("添加带教时间")],1)]),t._v(" "),a("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.showTimer,callback:function(e){t.showTimer=e},expression:"showTimer"}},[a("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.confirm,cancel:t.cancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)},staticRenderFns:[]};var n=a("VU/8")(i,s,!1,function(t){a("or3X")},"data-v-214d4a91",null);e.default=n.exports},or3X:function(t,e){}});
//# sourceMappingURL=44.e7558740b27da6b8081c.js.map
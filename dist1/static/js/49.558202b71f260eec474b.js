webpackJsonp([49],{"5YZg":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Gu7T"),n=a.n(i),s={name:"SubjectAppraise",components:{ViewList:a("p2g1").a},data:function(){var t=this;return{active:0,calendarShow:!1,identifyUpdateDate:new Date,currentDate:new Date,tabs:[{title:"待鉴定",loading:!1,finished:!1,error:!1,finishedText:"没有更多了",scrollTop:0,listObj:{list:[{field:"姓名：",name:"student",leftClass:"gray",render:function(t,e){return t[e].name}},{field:"专业：",name:"subjectCode",leftClass:"gray",render:function(e,a){return t.utils.getValueByKey(t.$store.state.majors,e[a])}},{field:"轮转科室：",name:"departmentName",leftClass:"gray"},{field:"出科小结：",name:"",leftClass:"gray",render:function(t,e){return'<span class="a">查看</span>'},click:function(e,a){t.$dialog.alert({title:"出科小结",message:e.summary})}},{field:"提交时间：",name:"applyDate",leftClass:"gray",render:function(e,a){return e[a]?t.utils.formatDate(e[a],"yyyy-MM-dd HH:mm"):""}}],click:this.viewAppraise},listData:[]},{title:"已鉴定",loading:!1,finished:!1,error:!1,finishedText:"没有更多了",scrollTop:0,listObj:{list:[{field:"姓名：",name:"student",leftClass:"gray",render:function(t,e){return t[e].name}},{field:"专业：",name:"subjectCode",leftClass:"gray",render:function(e,a){return t.utils.getValueByKey(t.$store.state.majors,e[a])}},{field:"轮转科室：",name:"departmentName",leftClass:"gray"},{field:"出科小结：",name:"",leftClass:"gray",render:function(t,e){return'<span class="a">查看</span>'},click:function(e,a){t.$dialog.alert({title:"出科小结",message:e.summary})}},{field:"鉴定结果：",name:"departmentOutIdentify",leftClass:"gray",render:function(e,a){return t.utils.getValueByKey(t.$store.state.appraisalGrade,e[a].compositeRating)}},{field:"鉴定时间：",name:"departmentOutIdentify",leftClass:"gray",render:function(e,a){var i=e[a].updateDate;return i?t.utils.formatDate(i,"yyyy-MM-dd HH:mm"):""}}],click:this.viewAppraise},listData:[]}]}},methods:{onClickLeft:function(){this.$store.state.tabActive=0,this.utils.goBack(this)},onLoad:function(){this.queryData()},change:function(t,e){var a=this;this.$nextTick(function(){a.$refs.layoutContent.scrollTop=a.tabs[a.active].scrollTop}),this.$store.state.tabActive=this.active},scroll:function(){this.tabs[this.active].scrollTop=this.$refs.layoutContent.scrollTop},selectTime:function(){this.calendarShow=!0},selectDate:function(t){var e=t.getFullYear(),a=(t.getMonth()+1).toString();a=1===a.length?"0"+a:a,this.tabs[this.active].listData=[],this.identifyUpdateDate=e+"-"+a,this.calendarShow=!1,this.queryData()},closePopup:function(){this.calendarShow=!1},formatter:function(t,e){return this.utils.pickerType(t,e)},queryData:function(){var t=this.tabs[this.active],e={identifyFlag:this.active,currentPage:Math.ceil(t.listData.length/this.$store.state.pageSize)+1,pageSize:this.$store.state.pageSize};1==this.active&&(e.identifyUpdateDate=this.identifyUpdateDate),this.utils.ajax({method:"post",data:e,url:this.api.identifyDepartmentOutApply,success:function(a){console.log(a),a.content.length?t.listData=[].concat(n()(t.listData),n()(a.content)):t.finishedText="",t.loading=!1,e.currentPage>=a.totalPages&&(t.finished=!0)},error:function(e){t.loading=!1,t.error=!0}},!0)},viewAppraise:function(t){this.$router.push({name:"GraduateAppraisal",query:{id:t.id},params:t})}},created:function(){this.identifyUpdateDate=this.utils.formatDate(this.$store.state.timestamp||(new Date).getTime(),"yyyy-MM"),this.active=this.$store.state.tabActive}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{staticClass:"header",attrs:{title:"出科鉴定",fixed:"","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),a("div",{ref:"layoutContent",staticClass:"layout_content",on:{scroll:function(e){return t.scroll()}}},[a("van-tabs",{attrs:{"offset-top":40,sticky:"",swipeable:"","title-active-color":"#1a7fe9",color:"#5fa4ec","line-height":2},on:{click:t.change,change:t.change},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,function(e,i){return a("div",[a("van-tab",{attrs:{title:e.title}},[a("van-list",{attrs:{finished:e.finished,error:e.error,"error-text":"请求失败，点击重新加载","finished-text":e.finishedText,"immediate-check":"",offset:50},on:{"update:error":function(a){return t.$set(e,"error",a)},load:function(e){return t.onLoad()}},model:{value:e.loading,callback:function(a){t.$set(e,"loading",a)},expression:"item.loading"}},[1==i?a("div",{staticClass:"identifyUpdateDate"},[a("van-cell",{attrs:{title:"鉴定时间","is-link":"",value:t.identifyUpdateDate},on:{click:function(e){return t.selectTime()}}})],1):t._e(),t._v(" "),a("ViewList",{attrs:{listObj:e.listObj,listData:e.listData}})],1)],1)],1)}),0),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}},[a("van-datetime-picker",{attrs:{type:"year-month",formatter:t.formatter},on:{confirm:t.selectDate,cancel:t.closePopup},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(s,r,!1,function(t){a("UWep")},"data-v-040536eb",null);e.default=l.exports},UWep:function(t,e){}});
//# sourceMappingURL=49.558202b71f260eec474b.js.map
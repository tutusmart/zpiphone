webpackJsonp([17],{WV4X:function(t,e){},"dNA/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"Leave",data:function(){return{leaveShow:!1,timeShow:!1,isAndroid:!1,leaveData:{attendanceTypeId:"",reason:"",type:"请选择",startDate:"请选择",endDate:"请选择",hours:"请选择",dayNum:"请选择",filePath:""},currentDate:new Date(this.$store.state.timestamp.replace(/-/g,"/")),type:"",maxLen:200,timeTitle:"",columns:[]}},methods:{onClickLeft:function(){this.utils.goBack(this)},onConfirm:function(t){this.leaveData.type=t.name,this.leaveData.attendanceTypeId=t.id,this.hideMask()},selected:function(t){this.type=t,"leaveType"===t?this.leaveShow=!0:(this.timeShow=!0,this.timeTitle="startDate"===t?"开始时间":"结束时间")},timeConfirm:function(t){this.leaveData[this.type]=this.utils.formatDate(t.getTime());var e=this.leaveData.startDate,a=this.leaveData.endDate;if("请选择"!==e&&"请选择"!==a){this.leaveData.hours=this.utils.timeToHours(new Date(e.replace(/-/g,"/")),new Date(a.replace(/-/g,"/")));var i=a.split(" ")[1],s=e.split(" ")[1],n=(new Date(this.utils.formatDate(a.split(" ")[0]+" "+e.split(" ")[1]).replace(/-/g,"/")).getTime()-new Date(e.replace(/-/g,"/")).getTime())/24/3600/1e3,l=i.split(":")[0],o=i.split(":")[1];s.split(":")[0]<12&&(n+=.5),(l>12||12==l&&o>0)&&(n+=.5),0==l&&0==o&&(n-=.5),this.leaveData.dayNum=n}this.hideMask()},hideMask:function(){this.timeShow=this.leaveShow=!1},formatter:function(t,e){return this.utils.pickerType(t,e)},getLeaveType:function(){var t=this;this.utils.ajax({method:"POST",data:{flag:1},url:this.api.queryAttendanceType,success:function(e){e.forEach(function(t){t.text=t.name}),t.columns=e}})},submit:function(){var t=this;this.leaveData.attendanceTypeId?"请选择"!==this.leaveData.startDate?"请选择"!==this.leaveData.endDate?this.leaveData.hours<.4?this.Toast("开始时间必须小于结束时间"):this.leaveData.reason?this.utils.ajax({method:"POST",data:this.leaveData,url:this.api.saveLeave,success:function(e){t.utils.goBack(t)}}):this.Toast("请填写请假原因"):this.Toast("请选择结束时间"):this.Toast("请选择开始时间"):this.Toast("请选择请假类型")}},created:function(){this.isAndroid=this.utils.isInAndroid(),this.getLeaveType()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"leaveWarp",class:t.isAndroid?"autoInput":""},[a("van-nav-bar",{staticClass:"header",attrs:{title:"请假申请",fixed:"","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),a("div",{staticClass:"layout_content"},[a("div",{staticClass:"module"},[a("van-cell",{attrs:{title:"请假类型","is-link":"",value:t.leaveData.type},on:{click:function(e){return t.selected("leaveType")}}})],1),t._v(" "),a("div",{staticClass:"module"},[a("van-cell",{attrs:{title:"开始时间","is-link":"",value:t.leaveData.startDate},on:{click:function(e){return t.selected("startDate")}}}),t._v(" "),a("van-cell",{attrs:{title:"结束时间","is-link":"",value:t.leaveData.endDate},on:{click:function(e){return t.selected("endDate")}}}),t._v(" "),a("van-cell",{attrs:{title:"请假小时数",value:t.leaveData.hours}}),t._v(" "),a("van-cell",{attrs:{title:"请假天数",value:t.leaveData.dayNum}})],1),t._v(" "),a("div",{staticClass:"module"},[a("van-cell",{attrs:{title:"请假原因"}}),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.leaveData.reason,expression:"leaveData.reason"}],staticClass:"textarea",attrs:{placeholder:"请输入请假原因",maxlength:t.maxLen},domProps:{value:t.leaveData.reason},on:{input:function(e){e.target.composing||t.$set(t.leaveData,"reason",e.target.value)}}}),t._v(" "),a("p",{staticClass:"leave_tips gray"},[t._v("不能超过"+t._s(t.maxLen)+"字符")])],1),t._v(" "),a("div",{staticClass:"bottomBtn"},[a("van-button",{attrs:{type:"info"},on:{click:t.submit}},[t._v("提交申请")])],1),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.leaveShow,callback:function(e){t.leaveShow=e},expression:"leaveShow"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"请假类型",columns:t.columns},on:{confirm:t.onConfirm,cancel:t.hideMask}})],1),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.timeShow,callback:function(e){t.timeShow=e},expression:"timeShow"}},[a("van-datetime-picker",{attrs:{title:t.timeTitle,type:"datetime",formatter:t.formatter},on:{confirm:t.timeConfirm,cancel:t.hideMask},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(i,s,!1,function(t){a("WV4X")},"data-v-fbcb9a20",null);e.default=n.exports}});
//# sourceMappingURL=17.687a7660037953fb2f73.js.map
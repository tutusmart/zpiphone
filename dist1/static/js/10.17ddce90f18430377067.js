webpackJsonp([10],{"500Y":function(t,e,i){"use strict";var a={name:"Retroactive",components:{},props:["retroactive"],data:function(){var t=this.utils.formatDate((new Date).getTime(),"yyyy-MM-dd").replace(/-/g,"/"),e=this.utils.formatDate(t,"yyyy-MM-dd");return{listData:this.retroactive,currentSignInDate:new Date,currentSignOutDate:new Date,dateTime:t,showSignIn:!1,showSignOut:!1,type:"",signTime:e,signInTime:"",signInTimeText:"",signOutTime:"",signOutTimeText:"",currentId:"",index:0}},created:function(){},methods:{dateClick:function(){this.show=!0,this.type=1},isDate:function(t){var e=new Date(t),i=e.getMonth()+1;!this.dateTime&&(this.dateTime=e.getFullYear()+"/"+i+"/"+e.getDay())},confirm:function(t){this.utils.formatDate(t.getTime(),"yyyy-MM-dd").replace(/-/g,"/");var e=this.utils.formatDate(t.getTime()),i=this.utils.formatDate(t.getTime()).replace(/-/g,"/");if(2==this.type){if(this.retroactive[this.index].signOutTime)if(!this.valiteSign(e,this.retroactive[this.index].signOutTime))return;this.showSignIn=!1,this.retroactive[this.index].signInTime=e,this.retroactive[this.index].signInTimeText=i,this.confirmBackDailySign()}else if(3==this.type){if(this.retroactive[this.index].signInTime)if(!this.valiteSign(this.retroactive[this.index].signInTime,e))return;this.showSignOut=!1,this.retroactive[this.index].signOutTime=e,this.retroactive[this.index].signOutTimeText=i,this.confirmBackDailySign()}},confirmBackDailySign:function(){var t=this,e=null,i=this;if(this.retroactive.forEach(function(a,n){a.signInTime&&a.signOutTime&&t.utils.getTime(a.signInTime)<t.utils.getTime(a.signOutTime)&&(e=a,i.index=n)}),e){var a={ids:[e.id],signInTime:e.signInTime,signOutTime:e.signOutTime};this.backDailySign(a)}},valiteSign:function(t,e){var i=!0;return t>=e?(this.Toast("签到时间不能大于签退时间"),i=!1):i},backDailySign:function(t){var e=this;this.utils.ajax({url:this.api.backDailySign,data:t,method:"POST",success:function(t){e.retroactive.splice(e.index,1),e.Toast("补签成功")}},!1)},formatter:function(t,e){return this.utils.pickerType(t,e)},cancel:function(){1==this.type?this.show=!1:2==this.type?this.showSignIn=!1:3==this.type&&(this.showSignOut=!1)},signindate:function(t,e,i){this.index=t,"sign"===e&&(this.showSignIn=!0,this.type=2,this.currentId=i.id),"signOut"===e&&(this.showSignOut=!0,this.type=3,this.currentId=i.id)}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[t._l(t.retroactive,function(e,a){return i("div",[i("div",{staticClass:"bottom"},[i("div",{staticClass:"surface"},[i("ul",[i("li",[i("p",[t._v("姓名：")]),t._v(" "),i("p",[t._v(t._s(e.studentName))])]),t._v(" "),i("li",[i("p",[t._v("班次：")]),t._v(" "),i("p",[t._v(t._s(e.typeName))])]),t._v(" "),i("li",[i("p",[t._v("轮转科室：")]),t._v(" "),i("p",[t._v(t._s(e.departmentName))])])])]),t._v(" "),i("div",{staticClass:"SignInButton"},[i("ul",{staticClass:"timeButton"},[i("li",[i("div",{staticClass:"signText"},[i("p",{staticClass:"p",class:{gray:e.signInTime},on:{click:function(i){return t.signindate(a,"sign",e)}}},[t._v("签到时间")]),t._v(" "),i("p",[t._v(t._s(e.signInTime))])])]),t._v(" "),i("li",[i("div",{staticClass:"signText"},[i("p",{staticClass:"p",class:{gray:e.signOutTime},on:{click:function(i){return t.signindate(a,"signOut",e)}}},[t._v("签退时间")]),t._v(" "),i("p",[t._v(t._s(e.signOutTime))])])])])])])])}),t._v(" "),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.showSignIn,callback:function(e){t.showSignIn=e},expression:"showSignIn"}},[i("van-datetime-picker",{attrs:{type:"datetime",formatter:t.formatter},on:{confirm:t.confirm,cancel:t.cancel},model:{value:t.currentSignInDate,callback:function(e){t.currentSignInDate=e},expression:"currentSignInDate"}})],1),t._v(" "),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.showSignOut,callback:function(e){t.showSignOut=e},expression:"showSignOut"}},[i("van-datetime-picker",{attrs:{type:"datetime",formatter:t.formatter},on:{confirm:t.confirm,cancel:t.cancel},model:{value:t.currentSignOutDate,callback:function(e){t.currentSignOutDate=e},expression:"currentSignOutDate"}})],1)],2)},staticRenderFns:[]};var s=i("VU/8")(a,n,!1,function(t){i("mJg1")},"data-v-426773df",null);e.a=s.exports},Lj0S:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("p2g1"),n=i("eu7k"),s={name:"SignInToReview",components:{Retroactive:i("500Y").a,ViewList:a.a,PassAndNoPass:n.a},data:function(){var t=this.utils.formatDate((new Date).getTime(),"yyyy-MM-dd").replace(/-/g,"/"),e=this.utils.formatDate((new Date).getTime(),"yyyy-MM-dd"),i=this.utils.formatDate((new Date).getTime(),"yyyy-MM-dd").replace(/-/g,"/");return{active:0,errorTip:"请选择需要审核的签到",tabs:[{title:"待审核",loading:!1,finished:!1,error:!1,finishedText:"没有更多了",listObj:{list:[{field:"姓名：",name:"studentName",leftClass:"gray"},{field:"班次：",name:"dutyTypeName",leftClass:"gray"},{field:"轮转科室：",name:"departmentName",leftClass:"gray"},{field:"签到时间：",name:"signInTimeText",leftClass:"gray"},{field:"签退时间：",name:"signOutTimeText",leftClass:"gray"}],click:this.viewAppraise},listData:[]},{title:"已审核",loading:!1,finished:!1,error:!1,finishedText:"没有更多了",listObj:{list:[{field:"姓名：",name:"studentName",leftClass:"gray"},{field:"班次：",name:"dutyTypeName",leftClass:"gray"},{field:"轮转科室：",name:"departmentName",leftClass:"gray"},{field:"签到时间：",name:"signInTimeText",leftClass:"gray"},{field:"签退时间：",name:"signOutTimeText",leftClass:"gray"},{field:"审核状态：",name:"auditFlag",leftClass:"gray",render:function(t,e){return 1==t.auditFlag?'<span class="green">审核通过</span>':2==t.auditFlag?'<span class="red">审核不通过</span>':void 0}},{field:"审核意见：",name:"auditOpinion",leftClass:"gray"}]},listData:[]},{title:"补签",loading:!1,finished:!1,error:!1,finishedText:"没有更多了",listData:[]}],dateTime:e,dateTime1:t,dateTimeShow:i,currentDate:new Date,currentDate1:new Date,show:!1,showTimerFlag:!1,currentPage:1,auditNote:""}},created:function(){this.active=this.$store.state.tabActive},methods:{onClickLeft:function(){this.utils.goBack(this)},showTimer:function(){this.showTimerFlag=!0},confirmTimer:function(t){this.showTimerFlag=!1,this.dateTime1=this.utils.formatDate(t.getTime(),"yyyy-MM-dd").replace(/-/g,"/"),this.getData(1)},onLoad:function(){console.log("load"),this.getData()},change:function(t){document.querySelector(".layout_content").scrollTop=0,this.active=t,this.$store.state.tabActive=this.active},getParams:function(){var t={},e="";switch(+this.active){case 0:t.auditFlags=["0"],e=this.api.pageDutyAuditList;break;case 1:t.auditFlags=["1","2"],t.signTime=this.dateTime,e=this.api.pageDutyAuditList;break;case 2:t.signTime=this.dateTime1.replace(/\//g,"-"),e=this.api.pageBackDailySign}return{params:t,url:e}},transformData:function(t){var e=this;return t.forEach(function(t){t.selected=!1,t.signInTimeText=t.signInTime?e.utils.formatDate(t.signInTime,"yyyy-MM-dd HH:mm").replace(/-/g,"/"):"",t.signOutTimeText=t.signOutTime?e.utils.formatDate(t.signOutTime,"yyyy-MM-dd HH:mm").replace(/-/g,"/"):"",t.auditFlagText=e.utils.getValueByKey(e.$store.state.auditStatus,t.auditFlag)||""}),t},getData:function(t){var e=this,i=this.tabs[this.active],a=this.getParams().params;this.currentPage=Math.ceil(i.listData.length/this.$store.state.pageSize),this.currentPage=this.currentPage+1,t&&(this.currentPage=1),a.currentPage=this.currentPage,a.pageSize=this.$store.state.pageSize;var n=this.getParams().url;this.utils.ajax({url:n,data:a,method:"POST",success:function(t){console.log("data---\x3e",t),e.totalPages=t.totalPages,1==a.currentPage?i.listData=e.transformData(t.content):i.listData=i.listData.concat(e.transformData(t.content)),0==t.content.length?i.finishedText="":i.finishedText="没有更多了",i.loading=!1,e.currentPage>=e.totalPages?i.finished=!0:i.finished=!1}},!0)},viewAppraise:function(t){t.selected=!t.selected},checkedList:function(){var t=this.tabs[this.active].listData.filter(function(t){return 1==t.selected});return t},signInAudit:function(t){var e=t.type;this.auditNote=t.data||"",this.auditAjax(e)},getAuditParams:function(t){var e={},i=[];return this.checkedList().forEach(function(t){var e=t.dailyId;i.push(e)}),e.ids=i,"pass"==t?(e.auditFlag="1",e.auditOpinion=""):"unPass"==t&&(e.auditFlag="2",e.auditOpinion=this.auditNote),e},auditAjax:function(t){var e=this,i=this.getAuditParams(t);console.log("params--\x3e--",i),this.utils.ajax({url:this.api.auditDuty,data:i,method:"POST",success:function(t){setTimeout(function(){e.Toast("审核成功")},100),e.getData(1)},error:function(t){console.log("error--\x3e--",t),e.Toast(t.error)}},!0)},formatter:function(t,e){return this.utils.pickerType(t,e)},confirm:function(t){this.show=!1,this.dateTime=this.utils.formatDate(t.getTime(),"yyyy-MM-dd"),this.dateTimeShow=this.dateTime.replace(/-/g,"/"),this.getData(1)},cancel:function(){this.show=!1},dateClick:function(){this.show=!0}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("van-nav-bar",{staticClass:"header",attrs:{title:"签到审核",fixed:"","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),i("div",{staticClass:"layout_content"},[i("van-tabs",{attrs:{swipeable:"",sticky:"","offset-top":40,"title-active-color":"#1a7fe9",color:"#5fa4ec","line-height":2},on:{click:t.change,change:t.change},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,function(e,a){return i("div",[i("van-tab",{attrs:{title:e.title}},[i("van-list",{attrs:{finished:e.finished,error:e.error,"error-text":"请求失败，点击重新加载","finished-text":e.finishedText,offset:50},on:{"update:error":function(i){return t.$set(e,"error",i)},load:function(e){return t.onLoad()}},model:{value:e.loading,callback:function(i){t.$set(e,"loading",i)},expression:"item.loading"}},[1==a?i("div",{staticClass:"audited"},[i("van-cell",{attrs:{title:"审核日期","is-link":"",value:t.dateTimeShow},on:{click:function(e){return t.dateClick()}}})],1):t._e(),t._v(" "),2==a?i("div",{staticClass:"audited"},[i("van-cell",{attrs:{title:"值班日期","is-link":"",value:t.dateTime1},on:{click:function(e){return t.showTimer()}}})],1):t._e(),t._v(" "),i("div",2==a?[i("Retroactive",{ref:"mychild",refInFor:!0,attrs:{retroactive:e.listData},on:{queryData:t.getData}})]:[i("ViewList",{attrs:{listObj:e.listObj,listData:e.listData}})],1)])],1)],1)}),0),t._v(" "),0==t.active?i("PassAndNoPass",{attrs:{error:t.errorTip,list:t.tabs[0].listData},on:{auditHandle:t.signInAudit,"click-left":function(e){return t.left()}}}):t._e(),t._v(" "),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.showTimerFlag,callback:function(e){t.showTimerFlag=e},expression:"showTimerFlag"}},[i("van-datetime-picker",{attrs:{type:"date",formatter:t.formatter},on:{confirm:t.confirmTimer,cancel:t.cancel},model:{value:t.currentDate1,callback:function(e){t.currentDate1=e},expression:"currentDate1"}})],1),t._v(" "),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("van-datetime-picker",{attrs:{type:"date",formatter:t.formatter},on:{confirm:t.confirm,cancel:t.cancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)],1)},staticRenderFns:[]};var o=i("VU/8")(s,r,!1,function(t){i("Wczh")},"data-v-55013ad0",null);e.default=o.exports},Wczh:function(t,e){},mJg1:function(t,e){}});
//# sourceMappingURL=10.17ddce90f18430377067.js.map